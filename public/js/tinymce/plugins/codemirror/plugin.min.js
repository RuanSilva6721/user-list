!function(){"use strict";function p(a){return parseInt(a,10)}function q(b,a){return 0==(a=b-a)?0:0<a?1:-1}function r(a,b,c){return{major:a,minor:b,patch:c}}function s(a){return(a=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(a))?r(p(a[1]),p(a[2]),p(a[3])):r(0,0,0)}function t(b,a){var c=q(b.major,a.major);return 0!==c||0!==(c=q(b.minor,a.minor))?c:0!==(a=q(b.patch,a.patch))?a:0}function u(a){return s([a.majorVersion,a.minorVersion].join(".").split(".").slice(0,3).join("."))}function v(a,b){return!!a&& -1===t(u(a),s(b))}function g(){}function c(a){return function(){return a}}var b=function(a,b){return function(){for(var e=[],c=0;c<arguments.length;c++)e[c]=arguments[c];var d=a.console;d&&b in d&&d[b].apply(d,arguments)}},w={log:b(window,"log"),error:b(window,"error"),warn:b(window,"warn")},d=c(!1),e=c(!0),a=function(){return x},x={fold:function(a,b){return a()},is:d,isSome:d,isNone:e,getOr:A,getOrThunk:z,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:A,orThunk:z,map:a,each:g,bind:a,exists:d,forall:e,filter:a,equals:y,equals_:y,toArray:function(){return[]},toString:c("none()")};function y(a){return a.isNone()}function z(a){return a()}function A(a){return a}function h(a){return K(a)?a:I.fromDom(a.dom.ownerDocument)}function B(a){return D.from(a.dom.parentNode).map(I.fromDom)}function C(a){null!==(a=a.dom).parentNode&&a.parentNode.removeChild(a)}function _(){return N(I.fromDom(document))}var i,j,k,l,m,n=function(g){function f(){return h}function b(a){return a(g)}var a=c(g),h={fold:function(b,a){return a(g)},is:function(a){return g===a},isSome:e,isNone:d,getOr:a,getOrThunk:a,getOrDie:a,getOrNull:a,getOrUndefined:a,or:f,orThunk:f,map:function(a){return n(a(g))},each:function(a){a(g)},bind:b,exists:b,forall:b,filter:function(a){return a(g)?h:x},toArray:function(){return[g]},toString:function(){return"some("+g+")"},equals:function(a){return a.is(g)},equals_:function(a,b){return a.fold(d,function(a){return b(g,a)})}};return h},D={some:n,none:a,from:function(a){return null==a?x:n(a)}},b=function(a){return function(b){return typeof b===a}},E=(i="string",function(b){var a;return b=typeof(a=b),(null===a?"null":"object"==b&&(Array.prototype.isPrototypeOf(a)||a.constructor&&"Array"===a.constructor.name)?"array":"object"==b&&(String.prototype.isPrototypeOf(a)||a.constructor&&"String"===a.constructor.name)?"string":b)===i}),F=b("boolean"),f=b("function"),G=b("number"),H=function(){return(H=Object.assign||function(d){for(var a,b=1,e=arguments.length;b<e;b++)for(var c in a=arguments[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d}).apply(this,arguments)},o=function(a){if(null==a)throw new Error("Node cannot be null or undefined");return{dom:a}},I={fromHtml:function(b,a){if((a=(a||document).createElement("div")).innerHTML=b,!a.hasChildNodes()||1<a.childNodes.length)throw console.error("HTML does not have a single root node",b),new Error("HTML must have a single root node");return o(a.childNodes[0])},fromTag:function(a,b){return a=(b||document).createElement(a),o(a)},fromText:function(a,b){return a=(b||document).createTextNode(a),o(a)},fromDom:o,fromPoint:function(a,b,c){return D.from(a.dom.elementFromPoint(b,c)).map(o)}},a=("undefined"!=typeof window||Function("return this;")(),function(a){return function(b){return b.dom.nodeType===a}}),J=a(1),K=a(9),L=a(11),M=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode)?function(a){return I.fromDom(a.dom.getRootNode())}:h,N=function(a){if(null==(a=a.dom.body))throw new Error("Body is not available yet");return I.fromDom(a)},b={},a={exports:b};function O(a){return a.getParam("code_dialog_width",600)}k=b,l=a,m=j=void 0,function(a){"object"==typeof k&& void 0!==l?l.exports=a():"function"==typeof j&&j.amd?j([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=a()}(function(){return(function d(e,f,b){function c(a,i){if(!f[a]){if(!e[a]){var h="function"==typeof m&&m;if(!i&&h)return h(a,!0);if(g)return g(a,!0);throw(h=new Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",h}h=f[a]={exports:{}},e[a][0].call(h.exports,function(b){return c(e[a][1][b]||b)},h,h.exports,d,e,f,b)}return f[a].exports}for(var g="function"==typeof m&&m,a=0;a<b.length;a++)c(b[a]);return c})({1:[function(d,a,e){var f,g,a=a.exports={};function h(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function j(a){if(f===setTimeout)return setTimeout(a,0);if((f===h||!f)&&setTimeout)return f=setTimeout,setTimeout(a,0);try{return f(a,0)}catch(b){try{return f.call(null,a,0)}catch(c){return f.call(this,a,0)}}}!function(){try{f="function"==typeof setTimeout?setTimeout:h}catch(a){f=h}try{g="function"==typeof clearTimeout?clearTimeout:i}catch(b){g=i}}();var k,l=[],m=!1,n=-1;function o(){m&&k&&(m=!1,k.length?l=k.concat(l):n=-1,l.length&&p())}function p(){if(!m){var b=j(o);m=!0;for(var a=l.length;a;){for(k=l,l=[];++n<a;)k&&k[n].run();n=-1,a=l.length}k=null,m=!1,function(a){if(g===clearTimeout)return clearTimeout(a);if((g===i||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(a);try{g(a)}catch(b){try{return g.call(null,a)}catch(c){return g.call(this,a)}}}(b)}}function c(a,b){this.fun=a,this.array=b}function b(){}a.nextTick=function(d){var b=new Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];l.push(new c(d,b)),1!==l.length||m||j(p)},c.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=b,a.addListener=b,a.once=b,a.off=b,a.removeListener=b,a.removeAllListeners=b,a.emit=b,a.prependListener=b,a.prependOnceListener=b,a.listeners=function(a){return[]},a.binding=function(a){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(a){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],2:[function(a,b,c){(function(d){var c,e;function f(){}function a(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(a,this)}function g(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,a._immediateFn(function(){var a,d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){try{a=d(b._value)}catch(e){return void i(c.promise,e)}h(c.promise,a)}else(1===b._state?h:i)(c.promise,b._value)})):b._deferreds.push(c)}function h(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||"function"==typeof c)){var e,f,d=c.then;if(c instanceof a)return b._state=3,b._value=c,void j(b);if("function"==typeof d)return void l((e=d,f=c,function(){e.apply(f,arguments)}),b)}b._state=1,b._value=c,j(b)}catch(g){i(b,g)}}function i(a,b){a._state=2,a._value=b,j(a)}function j(b){2===b._state&&0===b._deferreds.length&&a._immediateFn(function(){b._handled||a._unhandledRejectionFn(b._value)});for(var c=0,d=b._deferreds.length;c<d;c++)g(b,b._deferreds[c]);b._deferreds=null}function k(a,b,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.promise=c}function l(b,c){var a=!1;try{b(function(b){a||(a=!0,h(c,b))},function(b){a||(a=!0,i(c,b))})}catch(d){if(a)return;a=!0,i(c,d)}}c=this,e=setTimeout,a.prototype.catch=function(a){return this.then(null,a)},a.prototype.then=function(b,c){var a=new this.constructor(f);return g(this,new k(b,c,a)),a},a.all=function(b){var c=Array.prototype.slice.call(b);return new a(function(b,d){if(0===c.length)return b([]);for(var e=c.length,a=0;a<c.length;a++)!function i(g,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var f=a.then;if("function"==typeof f)return void f.call(a,function(a){i(g,a)},d)}c[g]=a,0== --e&&b(c)}catch(h){d(h)}}(a,c[a])})},a.resolve=function(b){return b&&"object"==typeof b&&b.constructor===a?b:new a(function(a){a(b)})},a.reject=function(b){return new a(function(c,a){a(b)})},a.race=function(b){return new a(function(c,d){for(var a=0,e=b.length;a<e;a++)b[a].then(c,d)})},a._immediateFn="function"==typeof d?function(a){d(a)}:function(a){e(a,0)},a._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)},a._setImmediateFn=function(b){a._immediateFn=b},a._setUnhandledRejectionFn=function(b){a._unhandledRejectionFn=b},void 0!==b&&b.exports?b.exports=a:c.Promise||(c.Promise=a)}).call(this,a("timers").setImmediate)},{timers:3}],3:[function(a,b,c){(function(d,e){var f=a("process/browser.js").nextTick,g=Function.prototype.apply,h=Array.prototype.slice,i={},j=0;function b(a,b){this._id=a,this._clearFn=b}c.setTimeout=function(){return new b(g.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new b(g.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},b.prototype.unref=b.prototype.ref=function(){},b.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;0<=b&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof d?d:function(b){var a=j++,d=!(arguments.length<2)&&h.call(arguments,1);return i[a]=!0,f(function(){i[a]&&(d?b.apply(null,d):b.call(null),c.clearImmediate(a))}),a},c.clearImmediate="function"==typeof e?e:function(a){delete i[a]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(a,b,d){var c=a("promise-polyfill"),a="undefined"!=typeof window?window:Function("return this;")();b.exports={boltExport:a.Promise||c}},{"promise-polyfill":2}]},{},[4])(4)});var P=a.exports.boltExport;function Q(a){return D.from(tinymce.get).bind(function(b){return D.from(b(a))})}function R(f,c,a,b){function e(a){27!==a.keyCode&&a.stopPropagation()}void 0===b&&(b="");var i=function(a){var b=Q(a).map(function(b){var a;return a=b=M(I.fromDom(b.getElement())),L(a)?a:I.fromDom(h(a).dom.body)}).getOrThunk(_);if(J(b))return{element:b,destroy:g};var c=I.fromTag("div");return a=c,b.dom.appendChild(a.dom),{element:c,destroy:function(){return C(c)}}}(a.editorId),d=function(b,c){function a(d,a){return a&&!a()||setTimeout(function(){d.state.completionActive||d.showHint({completeSingle:!1,container:c})},100),b.Pass}return{completeAfter:a,completeIfAfterLt:function(c){return a(c,function(){var a=c.getCursor();return"<"===c.getRange(b.Pos(a.line,a.ch-1),a)})},completeIfInTag:function(c){return a(c,function(){var a=c.getTokenAt(c.getCursor());return!!("string"!==a.type||/['"]/.test(a.string.charAt(a.string.length-1))&&1!==a.string.length)&&b.innerMode(c.getMode(),a.state).state.tagName})}}}(f,i.element.dom),b={lineWrapping:a.lineWrapping,lineNumbers:a.lineNumbers,foldGutter:a.foldGutter,theme:a.theme,direction:a.direction,matchTags:{bothTags:!0},keyMap:"sublime",gutters:a.gutter?["CodeMirror-linenumbers","CodeMirror-foldgutter"]:[],extraKeys:{"Alt-F":"findPersistent","Ctrl-J":"toMatchingTag","Ctrl-B":"selectNextOccurrence","'<'":d.completeAfter,"'/'":d.completeIfAfterLt,"' '":d.completeIfInTag,"'='":d.completeIfInTag,"Ctrl-Q":function(a){a.foldCode(a.getCursor())}},mode:"text/html",value:b},j=f(c,b);return c.addEventListener("keyup",e),c.addEventListener("keydown",e),c.addEventListener("keypress",e),setTimeout(function(){j.focus(),a.cursor&&j.doc.setCursor(a.cursor)},tinymce.Env.ie?50:0),setTimeout(function(){return j.refresh()},200),{cmi:j,destroy:function(){c.removeEventListener("keyup",e),c.removeEventListener("keydown",e),c.removeEventListener("keypress",e),i.destroy()}}}function S(b,c,a){var d,e;return P.all([function(c,a){if(U[a])return P.resolve();var d,e,b=Q(a),f=b.bind(function(a){return D.from(null===(a=a.ui)|| void 0===a?void 0:a.styleSheetLoader)}).getOr(tinymce.DOM.styleSheetLoader);return b.each(function(b){b.on("remove",function(){f.unload&&f.unload(c),delete U[a]})}),U[a]=!0,d=c,e=f,new P(function(a,b){(e||tinymce.DOM.styleSheetLoader).load(d,a,b)})}(c,a),(a="tinymce.plugins.advcode.CodeMirror",tinymce.Resource||(d={},e={},tinymce.Resource={add:function(a,b){e[a]&&(e[a](b),delete e[a]),d[a]=P.resolve(b)},load:function(a,b){var f='Script at URL "'+b+'" failed to load',g='Script at URL "'+b+"\" did not call `tinymce.Resource.add('"+a+"', data)` within 1 second";if(void 0!==d[a])return d[a];var c=new P(function(c,d){var h=function(a,d,b){function c(a){return function(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];f||(f=!0,null!==g&&(clearTimeout(g),g=null),a.apply(null,c))}}void 0===b&&(b=1e3);var f=!1,g=null,a=c(a),e=c(d);return{reject:e,resolve:a,start:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];f||(g=setTimeout(function(){return e.apply(null,c)},b))}}}(c,d);e[a]=h.resolve,tinymce.ScriptLoader.loadScripts([b],function(){return h.start(g)},function(){return h.reject(f)})});return d[a]=c}}),tinymce.Resource.load(a,b))]).then(function(a){return a[0],(0,a[1])()})}function T(a,b){a.focus(),a.undoManager.transact(function(){a.setContent(b)}),a.selection.setCursorLocation(),a.nodeChanged()}var U={},$=function(b,a){b.windowManager.open({title:a.title,body:a.body,buttons:[{text:"Ok",subtype:"primary",onclick:"submit",disabled:!0},{text:"Cancel",onclick:"close"}],onPostRender:function(){var d,b,c=this.getRoot(),e=c.find("form > *")[0];b=c.getEl("body"),(d=new tinymce.ui.Throbber(b)).show(1e3),a.onPostRender(e).then(function(){d.hide(),c.statusbar.items().disabled(!1)})},onSubmit:function(b){a.onSubmit(b.data)},onClose:function(){a.onClose&&a.onClose()}})},V=Object.hasOwnProperty;function W(e,g,c){for(var a=e.dom,h=f(c)?c:d;a.parentNode;){a=a.parentNode;var b=I.fromDom(a);if(g(b))return D.some(b);if(h(b))break}return D.none()}function X(b){var d,c,a=function(e,c){var d,g,a=e.dom,h=e.selection,b=h.getBookmark(),a=(g=d=b,d="name",V.call(g,d))?a.select(b.name)[b.index]:a.select("#"+b.id+"_start")[0],a=D.from(a).map(function(a){var b=I.fromDom(e.getBody());return function(a,c){var d,e,b=I.fromHtml(ab),a=I.fromDom(a),a=(function(a,c,b){var d,e,g;return d=W,c(e=a)?D.some(a):f(b)&&b(a)?D.none():d(a,c,b)})(a,function(c){var a,b;return b="data-mce-bogus",!(!(a=(a=c).dom)||!a.hasAttribute)&&a.hasAttribute(b)},c).getOr(a);return e=b,B(d=a).each(function(a){a.dom.insertBefore(e.dom,d.dom)}),b}(a,function(c){var a;return a=b,c.dom===a.dom})}),c=c();return a.each(C),h.moveToBookmark(b),c}(b,function(){return b.getContent({source_view:!0})}),a=(function(b,d){for(var a=0;a<b.length;a++){var c=d(b[a],a);if(c.isSome())return c}return D.none()})(c=a.split(/\r?\n/),function(b,d){var a=b.indexOf(ab);return(-1!==a?D.some(a):D.none()).map(function(a){return b===ab?0===d?{line:d,ch:0}:{line:d-1,ch:c[d-1].length}:{line:d,ch:a}})}).getOr({line:0,ch:0});return{content:b.getContent({source_view:!0}),cursor:a}}function Y(a,b){var c,d,e=S(b.codeMirrorScriptUrl,b.codeMirrorCssUrl,b.editorId),f=(c=D.none(),d={get:function(){return c},set:function(a){c=a}},{clear:function(){return d.set(D.none())},set:function(a){return d.set(D.some(a))},isSet:function(){return d.get().isSome()},on:function(a){return d.get().each(a)}});$(a,{title:"Source code",body:{type:"panel",border:1,classes:"codemirror",minWidth:O(a),minHeight:O(a)},onPostRender:function(c){var g=c.getEl("body"),d=X(a),h=H(H({},b),{cursor:d.cursor});return e.then(function(a){return R(a,g,h,d.content)}).then(function(a){f.set(a)})},onSubmit:function(){return f.on(function(b){T(a,b.cmi.doc.getValue()),b.destroy()})},onClose:function(){return f.on(function(a){return a.destroy()})}})}function Z(c,b){var a=X(c),b=H(H({},b),{cursor:a.cursor}),a={title:"Source Code",size:"large",body:{type:"panel",items:[function(a){var b={name:"codeview",type:"customeditor",tag:"div"};if(c="5.0.12",!(d=tinymce)||1!==t(u(d),s(c)))return H(H({},b),{init:function(b){var c,d;return c=b,d=a,new P(function(g){var a,b,e=I.fromDom(c);a="width",b="100%",function(b,c,a){var d;if(!E(a))throw console.error("Invalid call to CSS.set. Property ",c,":: Value ",a,":: Element ",b),new Error("CSS value must be a string: "+a);void 0!==(d=b).style&&f(d.style.getPropertyValue)&&b.style.setProperty(c,a)}(e.dom,a,b),B(e).filter(J).each(function(d){var e,h,i,f,g,b,j,a,k,c,l,m,n;return e="mce-codemirror",void(void 0!==d.dom.classList?d.dom.classList.add(e):(h=d,i=e,f=h,g="class",b=i,b=(j=f,a=g,void 0===(a=(k=j,c=a,null===(c=k.dom.getAttribute(c))?void 0:c))||""===a?[]:a.split(" ")).concat([b]),l=f,m=g,n=b.join(" "),function(b,c,a){if(!(E(a)||F(a)||G(a)))throw console.error("Invalid call to Attribute.set. Key ",c,":: Value ",a,":: Element ",b),new Error("Attribute value was not simple");b.setAttribute(c,a+"")}(l.dom,m,n)))}),g(S(d.codeMirrorScriptUrl,d.codeMirrorCssUrl,d.editorId).then(function(a){var a=R(a,c,d),b=a.cmi;return{getValue:function(){return b.doc.getValue()},setValue:function(a){return b.doc.setValue(a)},destroy:a.destroy}}))})}});var d,c=a.customEditorScriptUrl;return H(H({},b),{scriptId:"tinymce.plugins.advcode.customeditor",scriptUrl:c,settings:a})}(b)]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{codeview:a.content},onSubmit:function(a){T(c,a.getData().codeview),a.close()}};c.windowManager.open(a)}function aa(a,b,c){return function(){var d,e,f,d={customEditorScriptUrl:(e=c)+"/customeditor.min.js",codeMirrorScriptUrl:(f=e,(d=b).getParam("codemirror_script",f+"/codemirror.min.js","string")),codeMirrorCssUrl:d.getParam("codemirror_css",e+"/codemirror.min.css","string"),lineWrapping:d.getParam("codemirror_linewrapping",!0,"boolean"),lineNumbers:d.getParam("codemirror_linenumbers",!0,"boolean"),foldGutter:d.getParam("codemirror_foldgutter",!0,"boolean"),theme:d.getParam("codemirror_theme","default","string"),direction:"rtl"===d.getBody().dir?"rtl":"ltr",gutter:d.getParam("codemirror_gutter",!0,"boolean"),editorId:d.id};a(b,d)}}var ab="<!--mce_cursor-->";tinymce.PluginManager.add("advcode",function(b,a){var e,d,c;return v(tinymce,"4.3.13")?(w.error("The advcode plugin requires at least 4.3.13 version of TinyMCE."),function(){}):(v(tinymce,"5.0.0")?(c=aa(Y,d=b,c=a),d.addCommand("mceCodeEditor",c),d.addButton("code",{icon:"code",tooltip:"Source code",onclick:c}),d.addMenuItem("code",{icon:"code",text:"Source code",context:"tools",onclick:c})):(e="sourcecode",a=aa(Z,b,a),b.addCommand("mceCodeEditor",a),b.ui.registry.addButton("code",{icon:e,tooltip:"Source code",onAction:a}),b.ui.registry.addMenuItem("code",{icon:e,text:"Source code",onAction:a})),{})})}()